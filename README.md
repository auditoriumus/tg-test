## Запуск

В корневой дирректории есть файл [docker-compose.yml](docker-compose.yml), где собрана сборка докер-контейнеров
В папке [deployment](deployment) содержатся docker-файлы сборки приложений и сервисов, а также volumes для бд и конфигурация веб-сервера

- находясь в корне приложения выполнить команду docker compose up -d

Приложение использует веб-хуки для получения сообщений из телеграм, поэтому необходимо использовать прокси с сертификатом (https), так как это требование телеграм

- после запуска приложения необходимо привязать телеграм-бота к сервису, для этого нужно пройти по ссылке:
  https://api.telegram.org/bot{tg-bot-token}}/setWebhook?url={host}/api/v1
где:
- tg-bot-token - api token телеграм-бота (можно посмотреть в специальном боте bot father)
- host - https адрес приложения

## Переменные среды

Помимо стандартных для фреймворка laravel переменных окружения, необходимо добавить:
- TG_TOKEN - в которой содержится api-token телеграм бота
- DB_PASSWORD - добавить переменную среды в файл .env в корне приложения (используется файлом [docker-compose.yml](docker-compose.yml))
- DB_USERNAME - добавить переменную среды в файл .env в корне приложения (используется файлом [docker-compose.yml](docker-compose.yml))

## Принцип работы

Пользователь телеграм отправляет сообщение:

![1.png](readme-docs%2F1.png)

Веб-приложение отображает список чатов с сообщениями (в данном случае один чат 5133638259):

![2.png](readme-docs%2F2.png)

Из веб-приложения можно ответить на сообщение:

![3.gif](readme-docs%2F3.gif)

После этого сообщение видно в веб-приложении:

![4.png](readme-docs%2F4.png)

На свое сообщение также можно ответить:

![5.gif](readme-docs%2F5.gif)

Если написать в бот от имени другого пользователя телеграм, в веб-сервисе добавится час

![6.png](readme-docs%2F6.png)


## Тесты:
Для запуска тестов использовать команду php artisan test (команды из контейнера запускаются по умолчанию от имени пользователя new_user)

![7.png](readme-docs%2F7.png)
